\begin{tikzpicture}[scale=0.399]

\node at (-8, 12.5) {TCP};
\node at (8, 12.5) {RDMA};


\draw[fill=gray!30, rounded corners=2pt] (-15.5,0) rectangle (-8.5,11);
\draw[fill=gray!30, rounded corners=2pt] (-7.5,0) rectangle (-0.5,11);
\draw[fill=gray!30, rounded corners=2pt] (0.5,0) rectangle (7.5,11);
\draw[fill=gray!30, rounded corners=2pt] (8.5,0) rectangle (15.5,11);


\node at (-12, 9.5) {Initiator};
\node at (-4, 9.5) {Target};
\node at (4, 9.5) {Initiator};
\node at (12, 9.5) {Target};

\draw[fill=eth!50] (-14.5,7) rectangle (-9.5,8);
\draw[fill=eth!50] (-6.5,7) rectangle (-1.5,8);
\draw[fill=dis!50] (6.5,7) rectangle (1.5,8);
\draw[fill=dis!50] (14.5,7) rectangle (9.5,8);

\draw[fill=eth!50] (-14.5,5) rectangle (-9.5,6);
\draw[fill=eth!50] (-6.5,5) rectangle (-1.5,6);
\draw[fill=dis!50] (6.5,5) rectangle (3.5,6);
\draw[fill=dis!50] (14.5,5) rectangle (11.5,6);

\draw[fill=eth!50] (-14.5,3) rectangle (-9.5,4);
\draw[fill=eth!50] (-6.5,3) rectangle (-1.5,4);
\draw[fill=dis!50] (6.5,3) rectangle (3.5,4);
\draw[fill=dis!50] (14.5,3) rectangle (11.5,4);

\draw[fill=eth!50] (-14.5,1) rectangle (-9.5,2);
\draw[fill=eth!50] (-6.5,1) rectangle (-1.5,2);
\draw[fill=dis!50] (6.5,1) rectangle (3.5,2);
\draw[fill=dis!50] (14.5,1) rectangle (11.5,2);

\draw[fill=ib!50] (-14.5,-1) rectangle (-9.5,-2);
\draw[fill=ib!50] (-6.5,-1) rectangle (-1.5,-2);
\draw[fill=ib!50] (6.5,-1) rectangle (1.5,-2);
\draw[fill=ib!50] (14.5,-1) rectangle (9.5,-2);

\draw[fill=ssocks!50] (-14.25,7.25) rectangle (-12.75,7.75);
\node[scale=0.75] at (-13.5,7.5) {\tiny Buf};
\node[scale=0.75] at (-11,7.5) {\tiny Application};

\draw[fill=ssocks!50] (-6.25,7.25) rectangle (-4.75,7.75);
\node[scale=0.75] at (-5.5,7.5) {\tiny Buf};
\node[scale=0.75] at (-3,7.5) {\tiny Application};

\draw[fill=ssocks!50] (1.75,7.25) rectangle (3.25,7.75);
\node[scale=0.75] at (2.5,7.5) {\tiny Buf};
\node[scale=0.75] at (5,7.5) {\tiny Application};

\draw[fill=ssocks!50] (9.75,7.25) rectangle (11.25,7.75);
\node[scale=0.75] at (10.5,7.5) {\tiny Buf};
\node[scale=0.75] at (13,7.5) {\tiny Application};


\draw[fill=ssocks!50] (-14.25,5.25) rectangle (-12.75,5.75);
\node[scale=0.75] at (-13.5,5.5) {\tiny Buf};
\node[scale=0.75] at (-11,5.5) {\tiny Sockets};

\draw[fill=ssocks!50] (-6.25,5.25) rectangle (-4.75,5.75);
\node[scale=0.75] at (-5.5,5.5) {\tiny Buf};
\node[scale=0.75] at (-3,5.5) {\tiny Sockets};

\node[scale=0.75] at (5,5.5) {\tiny Sockets};

\node[scale=0.75] at (13,5.5) {\tiny Sockets};

\draw[fill=ssocks!50] (-14.25,3.25) rectangle (-12.75,3.75);
\node[scale=0.75] at (-13.5,3.5) {\tiny Buf};
\node[scale=0.75] at (-11,3.5) {\tiny Transport};

\draw[fill=ssocks!50] (-6.25,3.25) rectangle (-4.75,3.75);
\node[scale=0.75] at (-5.5,3.5) {\tiny Buf};
\node[scale=0.75] at (-3,3.5) {\tiny Transport};

\node[scale=0.75] at (5,3.5) {\tiny Transport};

\node[scale=0.75] at (13,3.5) {\tiny Transport};

\draw[fill=ssocks!50] (-14.25,1.25) rectangle (-12.75,1.75);
\node[scale=0.75] at (-13.5,1.5) {\tiny Buf};
\node[scale=0.75] at (-11,1.5) {\tiny NIC Driver};

\draw[fill=ssocks!50] (-6.25,1.25) rectangle (-4.75,1.75);
\node[scale=0.75] at (-5.5,1.5) {\tiny Buf};
\node[scale=0.75] at (-3,1.5) {\tiny NIC Driver};

\node[scale=0.75] at (5,1.5) {\tiny NIC Driver};

\node[scale=0.75] at (13,1.5) {\tiny NIC Driver};

\draw[fill=ssocks!50] (-14.25,-1.25) rectangle (-12.75,-1.75);
\node[scale=0.75] at (-13.5,-1.5) {\tiny Buf};
\node[scale=0.75] at (-11,-1.5) {\tiny NIC};

\draw[fill=ssocks!50] (-6.25,-1.25) rectangle (-4.75,-1.75);
\node[scale=0.75] at (-5.5,-1.5) {\tiny Buf};
\node[scale=0.75] at (-3,-1.5) {\tiny NIC};

\draw[fill=ssocks!50] (1.75,-1.25) rectangle (3.25,-1.75);
\node[scale=0.75] at (2.5,-1.5) {\tiny Buf};
\node[scale=0.75] at (5,-1.5) {\tiny RNIC};

\draw[fill=ssocks!50] (9.75,-1.25) rectangle (11.25,-1.75);
\node[scale=0.75] at (10.5,-1.5) {\tiny Buf};
\node[scale=0.75] at (13,-1.5) {\tiny RNIC};

\draw[->] (-13.5, 7.25) -- (-13.5, 6);
\draw[->] (-13.5, 5.25) -- (-13.5, 4);
\draw[->] (-13.5, 3.25) -- (-13.5, 2);
\draw[->] (-13.5, 1.25) -- (-13.5, -1);

\draw[<-] (-5.5, 7) -- (-5.5, 5.75);
\draw[<-] (-5.5, 5) -- (-5.5, 3.75);
\draw[<-] (-5.5, 3) -- (-5.5, 1.75);
\draw[<-] (-5.5, 1) -- (-5.5, -1.25);

\draw[->, dashed] (-13.5, -1.75) -- (-13.5, -2.75) -- (-5.5, -2.75) --(-5.5, -2);

\draw[->] (2.5, 7.25) -- (2.5, -1);

\draw[<-] (10.5, 7) -- (10.5, -1.25);

\draw[->, dashed] (2.5, -1.75) -- (2.5, -2.75) -- (10.5, -2.75) --(10.5, -2);

\node at (-9.5, -3.2) {\tiny Ethernet Link};
\node at (6.5, -3.2) {\tiny InfiniBand / PCIe Link};

\end{tikzpicture}